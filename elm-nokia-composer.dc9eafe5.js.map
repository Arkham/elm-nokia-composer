{"version":3,"sources":["index.js"],"names":["app","Elm","Main","init","node","document","querySelector","context","play","tune","real","Float32Array","imag","fill","wave","createPeriodicWave","reduce","acc","elem","oscillator","createOscillator","setPeriodicWave","frequency","value","gainNode","createGain","gain","connect","destination","startMoment","currentTime","now","endMoment","duration","setTargetAtTime","start","stop","lastOscillator","playLoop","result","onended","ports","subscribe","data","console","log","AudioContext","looping","ringtone","finished","send","close"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","file":"elm-nokia-composer.dc9eafe5.js","sourceRoot":"..","sourcesContent":["import { Elm } from './src/Main.elm'\n\nlet app = Elm.Main.init({ node: document.querySelector('main') })\n\nlet context;\n\nlet play = function(tune, context) {\n  let real = new Float32Array([0.26, 0.36, 0.57, 0.84, 1, 0.79, 0.72, 0.76, 0.82, 0.84, 0.64, 0.35, 0.12, 0.19, 0.23, 0.21, 0.08, 0.10, 0.17, 0.27, 0.22, 0.20, 0.22, 0.15, 0.13, 0.12, 0.11, 0.11, 0.10, 0.09, 0.09, 0.08, 0.08, 0.07, 0.08, 0.06, 0.04, 0.03, 0.02, 0.02, 0.02, 0.02, 0.02, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0, 0]);\n  let imag = new Float32Array(64);\n  imag.fill(0);\n  let wave = context.createPeriodicWave(real, imag);\n\n  return tune.reduce(function(acc, elem) {\n    let oscillator = context.createOscillator();\n    oscillator.setPeriodicWave(wave);\n    oscillator.frequency.value = elem.frequency;\n\n    let gainNode = context.createGain();\n    gainNode.gain.value = 0;\n\n    oscillator.connect(gainNode);\n    gainNode.connect(context.destination);\n\n    let startMoment = context.currentTime + acc.now;\n    let endMoment = startMoment + elem.duration;\n\n    if (elem.frequency !== 0) {\n      gainNode.gain.setTargetAtTime(1.0, startMoment, 0.002);\n      gainNode.gain.setTargetAtTime(0, endMoment - 0.002, 0.002);\n    }\n\n    oscillator.start(startMoment);\n    oscillator.stop(endMoment);\n\n    return({\n      now: acc.now + elem.duration,\n      lastOscillator: oscillator\n    });\n  }, {\n    now: 0,\n    lastOscillator: null\n  });\n};\n\nlet playLoop = function(tune, context) {\n  let result = play(tune, context);\n  result.lastOscillator.onended = function() {\n    playLoop(tune, context);\n  };\n};\n\napp.ports.play.subscribe(function(data) {\n  console.log(data);\n  context = new AudioContext();\n\n  if (data.looping) {\n    playLoop(data.ringtone, context);\n  } else {\n    let result = play(data.ringtone, context);\n\n    result.lastOscillator.onended = function() {\n      app.ports.finished.send(\"done\");\n    }\n  }\n});\n\napp.ports.stop.subscribe(function() {\n  if (context) {\n    context.close();\n    context = null;\n  }\n});\n"]}